# PTrade SQLite数据缓存系统配置文件

# 数据库配置
database:
  path: "./data/simtradedata.db"
  timeout: 30.0
  backup_enabled: true
  backup_interval_hours: 24
  vacuum_interval_days: 7

# 支持的市场
markets:
  enabled: ["SZ", "SS", "HK", "US"]
  
  SZ:
    name: "深圳证券交易所"
    suffix: ".SZ"
    timezone: "Asia/Shanghai"
    currency: "CNY"
    trading_hours: "09:30-11:30,13:00-15:00"
    features: ["涨跌停限制", "T+1交易", "集合竞价"]
  
  SS:
    name: "上海证券交易所"
    suffix: ".SS"
    timezone: "Asia/Shanghai"
    currency: "CNY"
    trading_hours: "09:30-11:30,13:00-15:00"
    features: ["涨跌停限制", "T+1交易", "集合竞价"]
  
  HK:
    name: "香港证券交易所"
    suffix: ".HK"
    timezone: "Asia/Hong_Kong"
    currency: "HKD"
    trading_hours: "09:30-12:00,13:00-16:00"
    features: ["无涨跌停限制", "T+0交易"]
  
  US:
    name: "美国证券交易所"
    suffix: ".US"
    timezone: "America/New_York"
    currency: "USD"
    trading_hours: "09:30-16:00"
    features: ["无涨跌停限制", "T+0交易", "盘前盘后交易"]

# 数据源配置
data_sources:
  mootdx:
    enabled: true
    tdx_dir: "/mnt/c/new_tdx"  # 通达信安装目录
    use_online: true        # 是否使用在线接口
    market: "std"           # std=标准市场, ext=扩展市场
    timeout: 10
    retry_times: 3
    retry_delay: 1
    rate_limit: 300         # 每分钟请求数限制

  baostock:
    enabled: true
    timeout: 15
    retry_times: 3
    retry_delay: 2
    rate_limit: 200

  qstock:
    enabled: true
    timeout: 10
    retry_times: 3
    retry_delay: 1
    rate_limit: 150

# 支持的频率
frequencies:
  supported: ["1m", "5m", "15m", "30m", "60m", "120m", "1d", "1w", "1y"]
  default: "1d"
  minute_frequencies: ["1m", "5m", "15m", "30m", "60m", "120m"]
  daily_frequencies: ["1d", "1w", "1y"]

# 数据同步配置
sync:
  enabled: true
  daily_schedule: "02:00"  # 每日凌晨2点同步
  auto_gap_fix: true
  max_gap_days: 30
  max_concurrent_tasks: 5
  batch_size: 100
  minute_data_retention_days: 30   # 分钟线数据保留30天
  daily_data_retention_days: 1095  # 日线数据保留3年

# 查询性能配置
query:
  default_limit: 1000
  max_limit: 10000
  cache_enabled: true
  cache_ttl_seconds: 300  # 缓存5分钟
  parallel_query_enabled: true
  max_parallel_queries: 10

# 日志配置
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file_enabled: true
  file_path: "./logs/simtradedata.log"
  file_max_size: "10MB"
  file_backup_count: 5
  console_enabled: true

# 监控配置
monitoring:
  enabled: true
  metrics_enabled: true
  health_check_interval: 60  # 健康检查间隔(秒)
  performance_log_enabled: true
  slow_query_threshold: 1000  # 慢查询阈值(毫秒)

# API配置
api:
  enabled_apis:
    # 高优先级API
    - "get_history"
    - "get_price"
    - "get_Ashares"
    - "get_stock_info"
    - "get_trade_days"
    - "get_all_trade_days"
    - "get_fundamentals"
    - "get_stock_blocks"
    - "get_snapshot"
  
  rate_limit_enabled: true
  rate_limit_per_minute: 1000
  response_format: "pandas"  # pandas/json/dict
  error_handling: "strict"   # strict/lenient

# 扩展功能配置
extensions:
  technical_indicators_enabled: true
  custom_fields_enabled: true
  data_export_enabled: true
  backup_restore_enabled: true
